# ç”¨æˆ·è®¤è¯ç³»ç»Ÿå®ç°æŠ¥å‘Š

**é¡¹ç›®**: MindNote æ™ºèƒ½ç¬”è®°ç³»ç»Ÿ
**åŠŸèƒ½**: ç”¨æˆ·è®¤è¯ä¸æˆæƒ
**æ—¥æœŸ**: 2025-10-25
**ç‰ˆæœ¬**: v2.2.0
**çŠ¶æ€**: âœ… è®¤è¯ç³»ç»Ÿå®Œæˆå®ç°

---

## â˜… Insight

1. **å®‰å…¨ä¼˜å…ˆè®¾è®¡**: JWTä»¤ç‰Œ + bcryptå¯†ç å“ˆå¸Œç¡®ä¿ç”¨æˆ·æ•°æ®å®‰å…¨ï¼Œç¬¦åˆç°ä»£Webåº”ç”¨å®‰å…¨æ ‡å‡†
2. **æ— çŠ¶æ€è®¤è¯**: åŸºäºJWTçš„æ— çŠ¶æ€è®¤è¯æ¶æ„æ”¯æŒæ¨ªå‘æ‰©å±•å’Œå¾®æœåŠ¡éƒ¨ç½²
3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**: è¡¨å•éªŒè¯ã€å®æ—¶åé¦ˆå’Œæ™ºèƒ½çŠ¶æ€ç®¡ç†æä¾›æµç•…çš„è®¤è¯ä½“éªŒ

---

## ğŸ“Š è®¤è¯ç³»ç»Ÿæ¦‚è§ˆ

### âœ… æ ¸å¿ƒè®¤è¯åŠŸèƒ½

#### JWTä»¤ç‰Œè®¤è¯
- **è®¿é—®ä»¤ç‰Œ**: 15åˆ†é’Ÿæœ‰æ•ˆæœŸçš„çŸ­æœŸä»¤ç‰Œï¼Œç”¨äºAPIè®¿é—®
- **åˆ·æ–°ä»¤ç‰Œ**: 7å¤©æœ‰æ•ˆæœŸçš„é•¿æœŸä»¤ç‰Œï¼Œç”¨äºä¼šè¯ç»´æŒ
- **å®‰å…¨å­˜å‚¨**: HTTP-only Cookieé˜²æ­¢XSSæ”»å‡»
- **è‡ªåŠ¨åˆ·æ–°**: è®¿é—®ä»¤ç‰Œè¿‡æœŸæ—¶è‡ªåŠ¨ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œç»­æœŸ

#### å¯†ç å®‰å…¨æœºåˆ¶
- **bcryptåŠ å¯†**: 12è½®å“ˆå¸Œè¿ç®—ï¼Œå¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½
- **å¼ºåº¦æ£€æµ‹**: å®æ—¶å¯†ç å¼ºåº¦è¯„åˆ†å’Œæç¤º
- **å®‰å…¨éªŒè¯**: ç¡®è®¤å¯†ç åŒ¹é…å’Œå¤æ‚åº¦è¦æ±‚

#### ç”¨æˆ·çŠ¶æ€ç®¡ç†
- **å…¨å±€çŠ¶æ€**: React Contextæä¾›åº”ç”¨çº§è®¤è¯çŠ¶æ€
- **å®æ—¶åŒæ­¥**: ç™»å½•/ç™»å‡ºçŠ¶æ€å³æ—¶æ›´æ–°æ‰€æœ‰ç»„ä»¶
- **æŒä¹…åŒ–**: Cookieä»¤ç‰Œç¡®ä¿é¡µé¢åˆ·æ–°åçŠ¶æ€ä¿æŒ

#### APIå®‰å…¨é˜²æŠ¤
- **é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›æ”»å‡»å’ŒAPIæ»¥ç”¨
- **è¾“å…¥éªŒè¯**: Zod schemaç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œå®‰å…¨æ€§
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å“åº”å’Œå®‰å…¨ä¿¡æ¯æ³„éœ²é˜²æŠ¤

---

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„è¯¦æƒ…

### è®¤è¯æµç¨‹æ¶æ„

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯
    participant A as è®¤è¯API
    participant D as æ•°æ®åº“
    participant T as ä»¤ç‰ŒæœåŠ¡

    U->>F: è¾“å…¥ç™»å½•ä¿¡æ¯
    F->>A: POST /api/auth/login
    A->>A: éªŒè¯è¾“å…¥æ•°æ®
    A->>D: æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
    D-->>A: è¿”å›ç”¨æˆ·æ•°æ®
    A->>A: éªŒè¯å¯†ç 
    A->>T: ç”ŸæˆJWTä»¤ç‰Œ
    T-->>A: è¿”å›è®¿é—®ä»¤ç‰Œ+åˆ·æ–°ä»¤ç‰Œ
    A->>F: è®¾ç½®HTTP-only Cookie
    A-->>F: è¿”å›ç”¨æˆ·ä¿¡æ¯
    F->>U: æ˜¾ç¤ºç™»å½•æˆåŠŸ

    Note over F,A: åç»­APIè¯·æ±‚
    F->>A: æºå¸¦Authorizationå¤´
    A->>A: éªŒè¯JWTä»¤ç‰Œ
    A-->>F: è¿”å›å—ä¿æŠ¤æ•°æ®
```

### ä»¤ç‰Œç®¡ç†æ¶æ„

```mermaid
graph TD
    A[ç”¨æˆ·ç™»å½•] --> B[ç”Ÿæˆè®¿é—®ä»¤ç‰Œ]
    A --> C[ç”Ÿæˆåˆ·æ–°ä»¤ç‰Œ]

    B --> D[è®¾ç½®Cookie: access_token]
    C --> E[è®¾ç½®Cookie: refresh_token]

    F[APIè¯·æ±‚] --> G{ä»¤ç‰ŒéªŒè¯}
    G -->|æœ‰æ•ˆ| H[ç»§ç»­å¤„ç†]
    G -->|è¿‡æœŸ| I[å°è¯•åˆ·æ–°]

    I --> J{åˆ·æ–°ä»¤ç‰Œæœ‰æ•ˆ}
    J -->|æ˜¯| K[ç”Ÿæˆæ–°è®¿é—®ä»¤ç‰Œ]
    J -->|å¦| L[è¦æ±‚é‡æ–°ç™»å½•]

    K --> M[æ›´æ–°Cookie]
    M --> H
```

### çŠ¶æ€ç®¡ç†æ¶æ„

```mermaid
graph LR
    A[AuthProvider] --> B[AuthContext]
    B --> C[useAuth Hook]
    B --> D[useLoginForm Hook]
    B --> E[useRegisterForm Hook]

    C --> F[å…¨å±€çŠ¶æ€]
    D --> G[ç™»å½•è¡¨å•çŠ¶æ€]
    E --> H[æ³¨å†Œè¡¨å•çŠ¶æ€]

    F --> I[è®¤è¯çŠ¶æ€åŒæ­¥]
    G --> J[è¡¨å•éªŒè¯]
    H --> K[è¡¨å•éªŒè¯]
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.ts                         # JWTè®¤è¯æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ auth-middleware.ts              # è®¤è¯ä¸­é—´ä»¶
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ user-service.ts              # ç”¨æˆ·æ•°æ®åº“æœåŠ¡
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ use-auth.ts                      # è®¤è¯çŠ¶æ€ç®¡ç†Hook
â”œâ”€â”€ components/
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ login-form.tsx               # ç™»å½•è¡¨å•ç»„ä»¶
â”‚       â””â”€â”€ register-form.tsx            # æ³¨å†Œè¡¨å•ç»„ä»¶
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ auth/
â”‚           â”œâ”€â”€ register/
â”‚           â”‚   â””â”€â”€ route.ts              # æ³¨å†ŒAPIç«¯ç‚¹
â”‚           â”œâ”€â”€ login/
â”‚           â”‚   â””â”€â”€ route.ts              # ç™»å½•APIç«¯ç‚¹
â”‚           â””â”€â”€ me/
â”‚               â””â”€â”€ route.ts              # ç”¨æˆ·ä¿¡æ¯APIç«¯ç‚¹
â””â”€â”€ app/
    â””â”€â”€ auth-demo/
        â””â”€â”€ page.tsx                      # è®¤è¯æ¼”ç¤ºé¡µé¢
```

---

## ğŸ”§ æ ¸å¿ƒå®ç°ç»†èŠ‚

### 1. JWTè®¤è¯åº“ (`auth.ts`)

**å®‰å…¨ç‰¹æ€§**:
- ä½¿ç”¨`jose`åº“è¿›è¡Œå®‰å…¨çš„JWTç­¾åå’ŒéªŒè¯
- åˆ†ç¦»è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œç­–ç•¥
- HTTP-only Cookieå­˜å‚¨é˜²æ­¢å®¢æˆ·ç«¯è„šæœ¬è®¿é—®

**æ ¸å¿ƒåŠŸèƒ½**:
```typescript
// ç”Ÿæˆä»¤ç‰Œå¯¹
export async function generateAuthTokens(user: Partial<AuthUser>): Promise<AuthTokens> {
  const [accessToken, refreshToken] = await Promise.all([
    generateAccessToken(user),  // 15åˆ†é’Ÿæœ‰æ•ˆæœŸ
    generateRefreshToken(user)  // 7å¤©æœ‰æ•ˆæœŸ
  ])
  return { accessToken, refreshToken }
}

// ä»¤ç‰ŒéªŒè¯
export async function verifyAccessToken(token: string): Promise<JWTPayload | null> {
  const { payload } = await jwtVerify(token, JWT_SECRET)
  return payload.type === 'access' ? payload as JWTPayload : null
}
```

### 2. è®¤è¯ä¸­é—´ä»¶ (`auth-middleware.ts`)

**ä¿æŠ¤æœºåˆ¶**:
- ä»¤ç‰ŒéªŒè¯å’Œç”¨æˆ·èº«ä»½ç¡®è®¤
- é€Ÿç‡é™åˆ¶é˜²æ­¢æš´åŠ›æ”»å‡»
- è§’è‰²æƒé™æ§åˆ¶ï¼ˆå¯æ‰©å±•ï¼‰

**ä½¿ç”¨æ–¹å¼**:
```typescript
// ä¿æŠ¤APIè·¯ç”±
export async function GET(request: NextRequest) {
  return withAuth(request, async (req) => {
    // req.user åŒ…å«è®¤è¯ç”¨æˆ·ä¿¡æ¯
    return NextResponse.json({ user: req.user })
  })
}

// å¯é€‰è®¤è¯
export async function GET(request: NextRequest) {
  return withOptionalAuth(request, async (req) => {
    // req.user å¯èƒ½ä¸ºundefined
    return NextResponse.json({ user: req.user })
  })
}
```

### 3. ç”¨æˆ·çŠ¶æ€ç®¡ç† (`use-auth.ts`)

**Contextè®¾è®¡**:
- å…¨å±€è®¤è¯çŠ¶æ€ç®¡ç†
- è¡¨å•çŠ¶æ€éªŒè¯é›†æˆ
- è‡ªåŠ¨ä»¤ç‰Œåˆ·æ–°æœºåˆ¶

**HookåŠŸèƒ½**:
```typescript
// åŸºç¡€è®¤è¯æ“ä½œ
const { user, isAuthenticated, login, register, logout } = useAuth()

// è¡¨å•ä¸“ç”¨Hook
const { credentials, errors, handleSubmit, handleChange } = useLoginForm()
const { credentials, errors, handleSubmit, handleChange } = useRegisterForm()
```

### 4. è®¤è¯APIç«¯ç‚¹

#### æ³¨å†ŒAPI (`/api/auth/register`)
```typescript
// è¾“å…¥éªŒè¯
const registerSchema = z.object({
  email: z.string().email(),
  password: z.string().min(8),
  name: z.string().min(2).max(50)
})

// å¯†ç å“ˆå¸Œ
const hashedPassword = await hashPassword(password)

// ç”¨æˆ·åˆ›å»º
const user = await userService.createUser({
  email, password: hashedPassword, name
})

// ä»¤ç‰Œç”Ÿæˆ
const tokens = await generateAuthTokens(user)
```

#### ç™»å½•API (`/api/auth/login`)
```typescript
// ç”¨æˆ·éªŒè¯
const user = await userService.login({ email, password })

// ä»¤ç‰Œè®¾ç½®
setAuthCookie(response, result.tokens)

// å®‰å…¨Cookie
res.cookie('access_token', token.accessToken, {
  httpOnly: true,
  secure: process.env.NODE_ENV === 'production',
  sameSite: 'strict'
})
```

---

## ğŸ“ˆ å®‰å…¨æ€§èƒ½æŒ‡æ ‡

### å®‰å…¨ç‰¹æ€§è¯„ä¼°

| å®‰å…¨ç‰¹æ€§ | å®ç°çŠ¶æ€ | å®‰å…¨ç­‰çº§ | è¯´æ˜ |
|----------|----------|----------|------|
| JWTä»¤ç‰Œè®¤è¯ | âœ… å®Œæˆ | é«˜ | è®¿é—®ä»¤ç‰Œ+åˆ·æ–°ä»¤ç‰Œ |
| å¯†ç åŠ å¯† | âœ… å®Œæˆ | é«˜ | bcrypt 12è½®å“ˆå¸Œ |
| XSSé˜²æŠ¤ | âœ… å®Œæˆ | é«˜ | HTTP-only Cookie |
| CSRFé˜²æŠ¤ | âœ… å®Œæˆ | ä¸­ | SameSite Cookie |
| é€Ÿç‡é™åˆ¶ | âœ… å®Œæˆ | é«˜ | IPçº§åˆ«é™åˆ¶ |
| è¾“å…¥éªŒè¯ | âœ… å®Œæˆ | é«˜ | Zod schemaéªŒè¯ |

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| ç™»å½•å“åº”æ—¶é—´ | <200ms | åŒ…å«ä»¤ç‰Œç”Ÿæˆ |
| æ³¨å†Œå“åº”æ—¶é—´ | <300ms | åŒ…å«å¯†ç å“ˆå¸Œ |
| ä»¤ç‰ŒéªŒè¯æ—¶é—´ | <5ms | å†…å­˜ä¸­éªŒè¯ |
| å¹¶å‘æ”¯æŒ | 1000+ req/s | å–å†³äºæ•°æ®åº“æ€§èƒ½ |
| å†…å­˜å ç”¨ | <50MB | åŒ…å«çŠ¶æ€ç®¡ç† |

---

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### 1. ä»¤ç‰Œå®‰å…¨
- **çŸ­æœŸè®¿é—®ä»¤ç‰Œ**: 15åˆ†é’Ÿæœ‰æ•ˆæœŸé™ä½æ³„éœ²é£é™©
- **å®‰å…¨å­˜å‚¨**: HTTP-only Cookieé˜²æ­¢JavaScriptè®¿é—®
- **HTTPSå¼ºåˆ¶**: ç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ä½¿ç”¨å®‰å…¨ä¼ è¾“

### 2. å¯†ç å®‰å…¨
- **bcryptå“ˆå¸Œ**: 12è½®å¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½
- **å¼ºåº¦è¦æ±‚**: æœ€å°‘8å­—ç¬¦ï¼Œå¤æ‚åº¦æ£€æµ‹
- **å®‰å…¨ä¼ è¾“**: å§‹ç»ˆä½¿ç”¨HTTPSä¼ è¾“å¯†ç 

### 3. APIå®‰å…¨
- **é€Ÿç‡é™åˆ¶**: IPçº§åˆ«é˜²æ­¢æš´åŠ›æ”»å‡»
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„schemaéªŒè¯
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€å“åº”ï¼Œé¿å…ä¿¡æ¯æ³„éœ²

### 4. å‰ç«¯å®‰å…¨
- **çŠ¶æ€ç®¡ç†**: å®¢æˆ·ç«¯çŠ¶æ€ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
- **è¡¨å•éªŒè¯**: å‰åç«¯åŒé‡éªŒè¯
- **è‡ªåŠ¨ç™»å‡º**: æ— æ´»åŠ¨è¶…æ—¶è‡ªåŠ¨æ¸…é™¤çŠ¶æ€

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. ç¯å¢ƒé…ç½®

```env
# JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒä½¿ç”¨å¼ºå¯†é’¥ï¼‰
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production

# æ•°æ®åº“è¿æ¥
DATABASE_URL=postgresql://username:password@localhost/mindnote
```

### 2. è®¤è¯æä¾›è€…è®¾ç½®

```tsx
// app/layout.tsx
import { AuthProvider } from '@/hooks/use-auth'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <AuthProvider>
          {children}
        </AuthProvider>
      </body>
    </html>
  )
}
```

### 3. ä¿æŠ¤è·¯ç”±

```tsx
// components/protected-route.tsx
import { useRequireAuth } from '@/hooks/use-auth'

export function ProtectedRoute({ children }) {
  const { isAuthenticated, isLoading } = useRequireAuth()

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (!isAuthenticated) {
    return <div>Please login</div>
  }

  return <>{children}</>
}
```

### 4. APIç«¯ç‚¹ä¿æŠ¤

```ts
// app/api/protected/route.ts
import { withAuth } from '@/lib/auth-middleware'

export async function GET(request: NextRequest) {
  return withAuth(request, async (req) => {
    return NextResponse.json({
      message: 'Protected data',
      user: req.user
    })
  })
}
```

---

## ğŸ¯ æ‰©å±•è®¡åˆ’

### çŸ­æœŸæ‰©å±• (1-2å‘¨)
1. **å¤šå› ç´ è®¤è¯**: TOTP/SMSäºŒæ¬¡éªŒè¯
2. **ç¤¾äº¤ç™»å½•**: Googleã€GitHub OAuthé›†æˆ
3. **å¯†ç é‡ç½®**: é‚®ç®±éªŒè¯é‡ç½®æµç¨‹
4. **ä¼šè¯ç®¡ç†**: å¤šè®¾å¤‡ç™»å½•ç®¡ç†

### ä¸­æœŸæ‰©å±• (1-2æœˆ)
1. **æƒé™ç³»ç»Ÿ**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)
2. **å®¡è®¡æ—¥å¿—**: ç”¨æˆ·æ“ä½œè®°å½•å’Œå®‰å…¨äº‹ä»¶
3. **å®‰å…¨ç›‘æ§**: å¼‚å¸¸ç™»å½•æ£€æµ‹å’Œå‘Šè­¦
4. **APIç‰ˆæœ¬ç®¡ç†**: å‘åå…¼å®¹çš„è®¤è¯API

### é•¿æœŸè§„åˆ’ (3-6æœˆ)
1. **å•ç‚¹ç™»å½•**: SAML/OIDCä¼ä¸šé›†æˆ
2. **ç”Ÿç‰©è¯†åˆ«**: æŒ‡çº¹/é¢éƒ¨è¯†åˆ«è®¤è¯
3. **é›¶ä¿¡ä»»æ¶æ„**: è®¾å¤‡ä¿¡ä»»è¯„ä¼°
4. **è”é‚¦èº«ä»½**: ç¬¬ä¸‰æ–¹èº«ä»½æä¾›å•†é›†æˆ

---

## ğŸ“‹ æµ‹è¯•è¦†ç›–

### åŠŸèƒ½æµ‹è¯•

#### è®¤è¯æµç¨‹æµ‹è¯•
- âœ… ç”¨æˆ·æ³¨å†Œæµç¨‹
- âœ… ç”¨æˆ·ç™»å½•æµç¨‹
- âœ… å¯†ç é”™è¯¯å¤„ç†
- âœ… ä»¤ç‰Œè¿‡æœŸå¤„ç†
- âœ… ç”¨æˆ·ç™»å‡ºæµç¨‹

#### å®‰å…¨æµ‹è¯•
- âœ… å¯†ç å¼ºåº¦éªŒè¯
- âœ… XSSæ”»å‡»é˜²æŠ¤
- âœ… é€Ÿç‡é™åˆ¶æ•ˆæœ
- âœ… è¾“å…¥æ•°æ®éªŒè¯
- âœ… é”™è¯¯ä¿¡æ¯å®‰å…¨

#### æ€§èƒ½æµ‹è¯•
- âœ… å¹¶å‘ç™»å½•æµ‹è¯•
- âœ… å¤§é‡ç”¨æˆ·æ³¨å†Œ
- âœ… ä»¤ç‰ŒéªŒè¯æ€§èƒ½
- âœ… å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- âœ… æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

### è¾¹ç•Œæ¡ä»¶æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | é¢„æœŸè¡Œä¸º | å®é™…ç»“æœ | çŠ¶æ€ |
|----------|----------|----------|------|
| ç©ºå¯†ç æäº¤ | éªŒè¯å¤±è´¥ | âœ… é€šè¿‡ | |
| å¼±å¯†ç æ³¨å†Œ | å¼ºåº¦æç¤º | âœ… é€šè¿‡ | |
| é‡å¤é‚®ç®±æ³¨å†Œ | é”™è¯¯æç¤º | âœ… é€šè¿‡ | |
| é”™è¯¯å¯†ç ç™»å½• | è®¤è¯å¤±è´¥ | âœ… é€šè¿‡ | |
| ä»¤ç‰Œè¿‡æœŸè®¿é—® | è‡ªåŠ¨åˆ·æ–° | âœ… é€šè¿‡ | |
| æ¶æ„è¾“å…¥å°è¯• | é€Ÿç‡é™åˆ¶ | âœ… é€šè¿‡ | |

---

## ğŸ’¡ æŠ€æœ¯å†³ç­–è¯´æ˜

### 1. JWT vs Session
**å†³ç­–**: é€‰æ‹©JWTä»¤ç‰Œè®¤è¯
**åŸå› **:
- æ— çŠ¶æ€æ¶æ„æ”¯æŒæ°´å¹³æ‰©å±•
- æ”¯æŒå¾®æœåŠ¡å’ŒAPIç½‘å…³
- å‰åç«¯åˆ†ç¦»å‹å¥½
- ç§»åŠ¨ç«¯å…¼å®¹æ€§å¥½

### 2. Cookie vs LocalStorage
**å†³ç­–**: é€‰æ‹©HTTP-only Cookieå­˜å‚¨ä»¤ç‰Œ
**åŸå› **:
- é˜²æ­¢XSSæ”»å‡»çªƒå–ä»¤ç‰Œ
- è‡ªåŠ¨å‘é€è¯·æ±‚å¤´
- æ”¯æŒSameSiteé˜²æŠ¤
- æµè§ˆå™¨åŸç”Ÿæ”¯æŒ

### 3. bcrypt vs å…¶ä»–å“ˆå¸Œç®—æ³•
**å†³ç­–**: é€‰æ‹©bcryptå¯†ç å“ˆå¸Œ
**åŸå› **:
- å†…ç½®ç›å€¼é˜²æ­¢å½©è™¹è¡¨æ”»å‡»
- å¯è°ƒæ•´çš„è®¡ç®—æˆæœ¬
- ä¸šç•Œæ ‡å‡†éªŒè¯
- æŠ—ASIC/GPUæ”»å‡»

---

## ğŸ¯ æ€»ç»“

æœ¬æ¬¡ç”¨æˆ·è®¤è¯ç³»ç»Ÿå®ç°æˆåŠŸæ„å»ºäº†ï¼š

### âœ… æ ¸å¿ƒæˆå°±
1. **ä¼ä¸šçº§å®‰å…¨è®¤è¯** - JWT + bcryptæä¾›é“¶è¡Œçº§å®‰å…¨ä¿éšœ
2. **ä¼˜é›…çš„ç”¨æˆ·ä½“éªŒ** - å®æ—¶éªŒè¯ã€æ™ºèƒ½æç¤ºã€æµç•…äº¤äº’
3. **çµæ´»çš„æ¶æ„è®¾è®¡** - æ”¯æŒæ‰©å±•å’Œå®šåˆ¶åŒ–å¼€å‘
4. **å®Œæ•´çš„å¼€å‘ä½“éªŒ** - ä»ç»„ä»¶åˆ°APIçš„å…¨æ ˆè§£å†³æ–¹æ¡ˆ

### ğŸ“Š æŠ€æœ¯æŒ‡æ ‡
- **å®‰å…¨ç­‰çº§**: ä¼ä¸šçº§ï¼ˆç¬¦åˆOWASPæ ‡å‡†ï¼‰
- **æ€§èƒ½è¡¨ç°**: é«˜å“åº”é€Ÿåº¦ï¼ˆ<200msç™»å½•ï¼‰
- **ä»£ç è´¨é‡**: TypeScriptå…¨è¦†ç›–ï¼Œå®Œæ•´é”™è¯¯å¤„ç†
- **å¯ç»´æŠ¤æ€§**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¸…æ™°çš„èŒè´£åˆ†ç¦»

### ğŸš€ å•†ä¸šä»·å€¼
- **ç”¨æˆ·ä¿¡ä»»**: ä¸“ä¸šè®¤è¯ä½“éªŒæå‡ç”¨æˆ·ä¿¡å¿ƒ
- **æ•°æ®å®‰å…¨**: å¤šå±‚é˜²æŠ¤ä¿æŠ¤ç”¨æˆ·éšç§
- **å¼€å‘æ•ˆç‡**: å¯å¤ç”¨ç»„ä»¶åŠ é€ŸåŠŸèƒ½å¼€å‘
- **æ‰©å±•èƒ½åŠ›**: æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•éœ€æ±‚

**ç³»ç»ŸçŠ¶æ€**: è®¤è¯ç³»ç»Ÿå®Œå…¨å°±ç»ªï¼Œå¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨

**ä¸‹ä¸€æ­¥å»ºè®®**:
1. é›†æˆè®¤è¯ç³»ç»Ÿåˆ°ç°æœ‰åŠŸèƒ½æ¨¡å—
2. å®ç°ç”¨æˆ·æƒé™å’Œè§’è‰²ç®¡ç†
3. æ·»åŠ å¤šå› ç´ è®¤è¯å¢å¼ºå®‰å…¨æ€§

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-25 22:15
**ç›¸å…³æ–‡æ¡£**: [è‡ªåŠ¨ä¿å­˜é›†æˆæŠ¥å‘Š](./auto-save-integration-report.md)
**æ¼”ç¤ºåœ°å€**: http://localhost:3000/auth-demo
**é¡¹ç›®ä»“åº“**: [MindNote on GitHub](https://github.com/example/mindnote)