# Redis Security Configuration
# Additional security settings on top of the main redis.conf

# Disable dangerous commands
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command KEYS ""
rename-command CONFIG "CONFIG_b835c3f8a2d6e7b4"
rename-command SHUTDOWN "SHUTDOWN_b835c3f8a2d6e7b4"

# Require password for all operations
auth ${REDIS_PASSWORD}

# Enable protected mode (default)
protected-mode yes

# Only allow connections from localhost in development
# In production, this should be configured with proper network security
bind 127.0.0.1 ::1

# Set a timeout for idle clients
timeout 300

# Limit the maximum number of clients
maxclients 100

# Disable commands that can expose sensitive information
rename-command DEBUG "DEBUG_b835c3f8a2d6e7b4"
rename-command EVAL ""
rename-command SCRIPT ""
rename-command MODULE ""

# Enable slow log for security monitoring
slowlog-log-slower-than 10000
slowlog-max-len 128

# Enable command stats for monitoring
stat-enable-commands yes

# Set memory limits to prevent DoS attacks
maxmemory 256mb
maxmemory-policy allkeys-lru

# Enable AOF persistence for data durability
appendonly yes
appendfsync everysec

# Disable direct disk sync for security (in production, use appropriate setting)
stop-writes-on-bgsave-error yes

# Set log level
loglevel notice

# Enable notification for key events
notify-keyspace-events "Ex"

# Configure security-related events
# These events will be logged and can be monitored for security purposes